<div
  class="roadmap-item-card cursor-pointer rounded-xl p-3 shadow-sm transition-shadow hover:shadow-md sm:p-4"
  <% /* eslint-disable css-propertyvalueexpected */ %>
  style="background-color: <%= app.design?.suggestionCardBgColor %>"
  onclick="window.location.href='/apps/<%= item.applicationId %>/roadmap/<%= item._id %>'">
  <!-- Item Header -->
  <div class="mb-2 sm:mb-3">
    <div class="flex items-start justify-between">
      <div class="flex-1">
        <h3
          class="roadmap-item-title mb-1 line-clamp-2 text-sm font-medium transition-colors hover:text-blue-600 sm:mb-2 sm:text-base"
          <% /* eslint-disable css-propertyvalueexpected */ %>
          style="color: <%= app.design?.suggestionTextColor %>">
          <%= item.title %>
        </h3>
        <div class="mb-2 flex flex-wrap items-center gap-1 sm:gap-2">
          <!-- Simple Type Badge -->
          <% if (item.type) { %>
          <span
            class="roadmap-type-badge inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium sm:px-2.5"
            <% /* eslint-disable css-propertyvalueexpected */ %>
            style="background-color: <%= app.design?.suggestionMetaColor %>20; color: <%= app.design?.suggestionMetaColor %>">
            <%= item.type.charAt(0).toUpperCase() +
            item.type.slice(1).replace('-', ' ') %>
          </span>
          <% } %>

          <!-- Simple Priority Text -->
          <% if (item.priority) { %>
          <span class="roadmap-priority-text text-xs"
            <% /* eslint-disable css-propertyvalueexpected */ %>
            style="color: <%= app.design?.suggestionMetaColor %>">
            <%= item.priority.charAt(0).toUpperCase() + item.priority.slice(1)
            %> priority
          </span>
          <% } %>
        </div>
      </div>

      <% if (isOwner) { %>
      <div class="ml-2 flex flex-shrink-0 space-x-1">
        <a
          href="/apps/<%= item.applicationId %>/roadmap/<%= item._id %>/edit"
          onclick="event.stopPropagation()"
          class="roadmap-edit-btn p-1"
          <% /* eslint-disable css-propertyvalueexpected */ %>
          style="color: <%= app.design?.suggestionMetaColor %>">
          <i class="fas fa-edit text-xs sm:text-sm"></i>
        </a>
        <button
          onclick="event.stopPropagation(); deleteRoadmapItem('<%= item._id %>')"
          class="roadmap-delete-btn cursor-pointer p-1"
          <% /* eslint-disable css-propertyvalueexpected */ %>
          style="color: <%= app.design?.suggestionMetaColor %>">
          <i class="fas fa-trash text-xs sm:text-sm"></i>
        </button>
      </div>
      <% } %>
    </div>
  </div>

  <!-- Description -->
  <p
    class="roadmap-item-description mb-2 line-clamp-2 text-xs sm:mb-3 sm:line-clamp-3 sm:text-sm"
    <% /* eslint-disable css-propertyvalueexpected */ %>
    style="color: <%= app.design?.suggestionMetaColor %>">
    <%= item.description %>
  </p>

  <!-- Footer -->
  <div class="roadmap-footer-text flex items-center justify-between text-xs"
    <% /* eslint-disable css-propertyvalueexpected */ %>
    style="color: <%= app.design?.suggestionMetaColor %>">
    <div class="flex items-center space-x-2">
      <!-- Created Date -->
      <span> <%= moment(item.createdAt).format('MMM DD, YYYY') %> </span>
    </div>

    <!-- Dates -->
    <div class="text-right">
      <% if (item.estimatedReleaseDate) { %>
      <div>Est. <%= moment(item.estimatedReleaseDate).format('MMM DD') %></div>
      <% } %>
    </div>
  </div>
</div>

<% if (isOwner) { %>
<script>
  function deleteRoadmapItem(itemId) {
    if (confirm('Are you sure you want to delete this roadmap item?')) {
      fetch(`/apps/<%= item.applicationId %>/roadmap/${itemId}`, {
        method: 'DELETE',
        headers: {
          Accept: 'application/json',
          'Content-Type': 'application/json',
        },
      })
        .then(response => {
          if (response.ok) {
            return response.json();
          } else {
            return response.json().then(data => Promise.reject(data));
          }
        })
        .then(data => {
          // Show success message (optional)
          if (data.message) {
            alert(data.message);
          }
          window.location.reload();
        })
        .catch(error => {
          console.error('Error:', error);
          const errorMessage =
            error.error || 'Failed to delete roadmap item. Please try again.';
          alert(errorMessage);
        });
    }
  }
</script>
<% } %>
